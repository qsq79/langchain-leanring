# AutoGen å¤šæ™ºèƒ½ä½“å®¢æœç³»ç»Ÿ - é¡¹ç›®ç»“æ„è¯´æ˜æ–‡æ¡£

## 1. é¡¹ç›®æ¦‚è¿°

### 1.1 é¡¹ç›®ç®€ä»‹
æœ¬é¡¹ç›®æ˜¯åŸºäº AutoGen æ¡†æ¶æ„å»ºçš„å¤šæ™ºèƒ½ä½“å®¢æœç³»ç»Ÿï¼Œæ—¨åœ¨é€šè¿‡å¤šä¸ªæ™ºèƒ½ä½“ååŒå·¥ä½œæ¥å¤„ç†å®¢æˆ·æœåŠ¡é—®é¢˜ã€‚ç³»ç»Ÿèƒ½å¤Ÿè‡ªåŠ¨å¤„ç†å®¢æˆ·å…³äºè®¢å•çŠ¶æ€å’Œç‰©æµä¿¡æ¯çš„æŸ¥è¯¢ï¼Œå¹¶æä¾›æ™ºèƒ½åŒ–çš„å›å¤æœåŠ¡ã€‚

### 1.2 ä¸»è¦åŠŸèƒ½
- **è®¢å•çŠ¶æ€æŸ¥è¯¢**ï¼šAgent A è´Ÿè´£æŸ¥è¯¢è®¢å•çš„è¯¦ç»†çŠ¶æ€ä¿¡æ¯
- **ç‰©æµä¿¡æ¯æ£€æŸ¥**ï¼šAgent B è´Ÿè´£è·å–è®¢å•çš„ç‰©æµè·Ÿè¸ªä¿¡æ¯
- **ç»“æœæ±‡æ€»å›å¤**ï¼šAgent C è´Ÿè´£æ•´åˆä¿¡æ¯å¹¶ç”Ÿæˆç”¨æˆ·å‹å¥½çš„å›å¤
- **è‡ªåŠ¨é‡è¯•æœºåˆ¶**ï¼šæ”¯æŒæŒ‡æ•°çº§é€€é¿çš„ç½‘ç»œè¯·æ±‚é‡è¯•
- **è¯¦ç»†äº¤äº’å±•ç¤º**ï¼šå®æ—¶æ˜¾ç¤ºæ™ºèƒ½ä½“ä¹‹é—´çš„äº¤äº’è¿‡ç¨‹

### 1.3 æŠ€æœ¯ç‰¹ç‚¹
- åŸºäº AutoGen æ¡†æ¶çš„å¤šæ™ºèƒ½ä½“æ¶æ„
- å¼‚æ­¥å¤„ç†å’Œå¹¶å‘æ”¯æŒ
- å®Œå–„çš„é”™è¯¯å¤„ç†å’Œé‡è¯•æœºåˆ¶
- ä¸°å¯Œçš„å‘½ä»¤è¡Œç•Œé¢å±•ç¤º
- æ¨¡å—åŒ–è®¾è®¡ï¼Œæ˜“äºæ‰©å±•å’Œç»´æŠ¤

### 1.4 ä¸»è¦æŠ€æœ¯æ ˆ

#### æ ¸å¿ƒæ¡†æ¶
- **AutoGen (>=0.2.0)**: å¤šæ™ºèƒ½ä½“æ¡†æ¶ï¼Œè´Ÿè´£æ™ºèƒ½ä½“çš„åˆ›å»ºã€ç®¡ç†å’Œåè°ƒ
- **FastAPI (>=0.104.0)**: ç°ä»£åŒ–çš„ Web API æ¡†æ¶ï¼Œç”¨äºæ„å»ºæ¨¡æ‹Ÿå†…éƒ¨ç³»ç»Ÿ
- **Uvicorn (>=0.24.0)**: ASGI æœåŠ¡å™¨ï¼Œç”¨äºè¿è¡Œ FastAPI åº”ç”¨

#### æ•°æ®å¤„ç†
- **Pydantic (>=2.5.0)**: æ•°æ®éªŒè¯å’Œåºåˆ—åŒ–
- **Pydantic-settings (>=2.1.0)**: é…ç½®ç®¡ç†

#### å¼‚æ­¥å’Œç½‘ç»œ
- **aiofiles (>=23.2.0)**: å¼‚æ­¥æ–‡ä»¶æ“ä½œ
- **httpx (>=0.25.0)**: ç°ä»£åŒ–çš„å¼‚æ­¥ HTTP å®¢æˆ·ç«¯
- **tenacity (>=8.2.0)**: é‡è¯•æœºåˆ¶åº“

#### AI å’Œè¯­è¨€æ¨¡å‹
- **OpenAI (>=1.3.0)**: OpenAI API å®¢æˆ·ç«¯

#### ç”¨æˆ·ç•Œé¢å’Œå·¥å…·
- **Rich (>=13.7.0)**: ä¸°å¯Œçš„å‘½ä»¤è¡Œç•Œé¢åº“
- **Colorama (>=0.4.6)**: è·¨å¹³å°å½©è‰²ç»ˆç«¯è¾“å‡º
- **Python-dotenv (>=1.0.0)**: ç¯å¢ƒå˜é‡ç®¡ç†

#### å¼€å‘å’Œæµ‹è¯•
- **Pytest (>=7.4.0)**: æµ‹è¯•æ¡†æ¶
- **Pytest-asyncio (>=0.21.0)**: å¼‚æ­¥æµ‹è¯•æ”¯æŒ
- **Black (>=23.11.0)**: ä»£ç æ ¼å¼åŒ–å·¥å…·

## 2. æ–‡ä»¶ç»“æ„è¯´æ˜

```
week1_2/
â”œâ”€â”€ .env.example                 # ç¯å¢ƒå˜é‡é…ç½®ç¤ºä¾‹æ–‡ä»¶
â”œâ”€â”€ main.py                      # é¡¹ç›®ä¸»å…¥å£æ–‡ä»¶ â­
â”œâ”€â”€ requirements.txt             # Python ä¾èµ–åŒ…åˆ—è¡¨ â­
â”œâ”€â”€ é¡¹ç›®æè¿°.txt                 # é¡¹ç›®éœ€æ±‚å’Œåœºæ™¯æè¿°
â”œâ”€â”€ é¡¹ç›®ç»“æ„è¯´æ˜æ–‡æ¡£.md          # æœ¬æ–‡æ¡£
â”œâ”€â”€ agents/                      # æ™ºèƒ½ä½“æ¨¡å—ç›®å½•
â”‚   â””â”€â”€ autogen_agents.py       # AutoGen æ™ºèƒ½ä½“å®ç° â­
â”œâ”€â”€ api/                         # API æœåŠ¡æ¨¡å—ç›®å½•
â”‚   â””â”€â”€ fastapi_server.py       # FastAPI æ¨¡æ‹ŸæœåŠ¡å™¨ â­
â”œâ”€â”€ config/                      # é…ç½®æ¨¡å—ç›®å½•
â”‚   â””â”€â”€ settings.py             # é¡¹ç›®é…ç½®ç®¡ç† â­
â”œâ”€â”€ core/                        # æ ¸å¿ƒåŠŸèƒ½æ¨¡å—ç›®å½•
â”‚   â””â”€â”€ logger.py               # æ—¥å¿—ç³»ç»Ÿé…ç½® â­
â”œâ”€â”€ tools/                       # å·¥å…·æ¨¡å—ç›®å½•
â”‚   â””â”€â”€ api_client.py           # API å®¢æˆ·ç«¯å·¥å…· â­
â”œâ”€â”€ utils/                       # å·¥å…·å‡½æ•°ç›®å½•
â”‚   â””â”€â”€ retry.py                # é‡è¯•æœºåˆ¶å®ç° â­
â”œâ”€â”€ logs/                        # æ—¥å¿—æ–‡ä»¶ç›®å½•
â”‚   â””â”€â”€ app.log                 # åº”ç”¨æ—¥å¿—æ–‡ä»¶
â””â”€â”€ venv/                        # Python è™šæ‹Ÿç¯å¢ƒç›®å½•
    â”œâ”€â”€ Include/                # å¤´æ–‡ä»¶ç›®å½•
    â”œâ”€â”€ Lib/                    # åº“æ–‡ä»¶ç›®å½•
    â”œâ”€â”€ Scripts/                # å¯æ‰§è¡Œæ–‡ä»¶ç›®å½•
    â”œâ”€â”€ pyvenv.cfg              # è™šæ‹Ÿç¯å¢ƒé…ç½®
    â””â”€â”€ share/                  # å…±äº«æ–‡ä»¶ç›®å½•
```

### 2.1 å…³é”®æ–‡ä»¶è¯¦ç»†è¯´æ˜

#### ğŸ”¥ æ ¸å¿ƒå…¥å£æ–‡ä»¶
- **`main.py`**: é¡¹ç›®ä¸»å…¥å£ï¼Œè´Ÿè´£å¯åŠ¨æœåŠ¡ã€è§£æå‘½ä»¤è¡Œå‚æ•°ã€åè°ƒå„æ¨¡å—å·¥ä½œ
  - æ”¯æŒå‘½ä»¤è¡Œå‚æ•°è§£æ
  - å¯åŠ¨ FastAPI æ¨¡æ‹ŸæœåŠ¡
  - åˆå§‹åŒ– AutoGen æ™ºèƒ½ä½“
  - å¤„ç†ç”¨æˆ·æŸ¥è¯¢è¯·æ±‚

#### ğŸ¤– æ™ºèƒ½ä½“æ¨¡å—
- **`agents/autogen_agents.py`**: AutoGen æ™ºèƒ½ä½“æ ¸å¿ƒå®ç°
  - å®šä¹‰ä¸‰ä¸ªä¸“é—¨çš„æ™ºèƒ½ä½“ï¼ˆè®¢å•æŸ¥è¯¢ã€ç‰©æµæŸ¥è¯¢ã€ç»“æœæ±‡æ€»ï¼‰
  - å®ç°æ™ºèƒ½ä½“é—´çš„é€šä¿¡åè®®
  - æä¾›äº¤äº’è¿‡ç¨‹çš„å¯è§†åŒ–å±•ç¤º
  - é›†æˆ API è°ƒç”¨åŠŸèƒ½

#### ğŸŒ API æœåŠ¡æ¨¡å—
- **`api/fastapi_server.py`**: æ¨¡æ‹Ÿå†…éƒ¨ç³»ç»Ÿçš„ REST API æœåŠ¡
  - æä¾›è®¢å•çŠ¶æ€æŸ¥è¯¢æ¥å£ (`/api/orders/{order_id}`)
  - æä¾›ç‰©æµä¿¡æ¯æŸ¥è¯¢æ¥å£ (`/api/logistics/{order_id}`)
  - åŒ…å«æ¨¡æ‹Ÿæ•°æ®å’Œé”™è¯¯å¤„ç†
  - æ”¯æŒ CORS è·¨åŸŸè¯·æ±‚

#### âš™ï¸ é…ç½®å’Œæ ¸å¿ƒæ¨¡å—
- **`config/settings.py`**: ç»Ÿä¸€çš„é…ç½®ç®¡ç†
  - OpenAI API é…ç½®
  - é‡è¯•æœºåˆ¶å‚æ•°
  - æ—¥å¿—ç³»ç»Ÿé…ç½®
  - æ¨¡æ‹ŸæœåŠ¡é…ç½®
  - æ™ºèƒ½ä½“è¡Œä¸ºé…ç½®

- **`core/logger.py`**: æ—¥å¿—ç³»ç»Ÿå®ç°
  - æ”¯æŒæ–‡ä»¶å’Œæ§åˆ¶å°åŒé‡è¾“å‡º
  - UTF-8 ç¼–ç æ”¯æŒ
  - æ—¥å¿—è½®è½¬åŠŸèƒ½
  - ç»Ÿä¸€çš„æ—¥å¿—æ ¼å¼

#### ğŸ”§ å·¥å…·æ¨¡å—
- **`tools/api_client.py`**: API å®¢æˆ·ç«¯å°è£…
  - å°è£… HTTP è¯·æ±‚é€»è¾‘
  - é›†æˆé‡è¯•æœºåˆ¶
  - æä¾›å‹å¥½çš„é”™è¯¯å¤„ç†
  - æ”¯æŒå¼‚æ­¥æ“ä½œ

- **`utils/retry.py`**: é‡è¯•æœºåˆ¶å®ç°
  - åŸºäº tenacity åº“çš„æŒ‡æ•°é€€é¿é‡è¯•
  - å¯é…ç½®çš„é‡è¯•ç­–ç•¥
  - HTTP é”™è¯¯æ™ºèƒ½åˆ¤æ–­
  - è¯¦ç»†çš„é‡è¯•æ—¥å¿—

#### ğŸ“‹ é…ç½®æ–‡ä»¶
- **`.env.example`**: ç¯å¢ƒå˜é‡é…ç½®æ¨¡æ¿
- **`requirements.txt`**: Python ä¾èµ–åŒ…æ¸…å•
- **`é¡¹ç›®æè¿°.txt`**: é¡¹ç›®éœ€æ±‚å’ŒæŠ€æœ¯éš¾ç‚¹è¯´æ˜

## 3. è¿è¡Œè¯´æ˜

### 3.1 ç¯å¢ƒé…ç½®è¦æ±‚

#### ç³»ç»Ÿè¦æ±‚
- **æ“ä½œç³»ç»Ÿ**: Windows 10/11, macOS 10.14+, Linux (Ubuntu 18.04+)
- **Python ç‰ˆæœ¬**: Python 3.9 æˆ–æ›´é«˜ç‰ˆæœ¬
- **å†…å­˜**: è‡³å°‘ 4GB RAM
- **ç£ç›˜ç©ºé—´**: è‡³å°‘ 2GB å¯ç”¨ç©ºé—´

#### å¿…éœ€çš„å¤–éƒ¨æœåŠ¡
- **OpenAI API**: éœ€è¦æœ‰æ•ˆçš„ OpenAI API å¯†é’¥ï¼ˆå¯é€‰ï¼Œç”¨äºæ™ºèƒ½ä½“å¯¹è¯ï¼‰
- **ç½‘ç»œè¿æ¥**: ç”¨äº API è°ƒç”¨å’Œä¾èµ–åŒ…ä¸‹è½½

### 3.2 å®‰è£…ä¾èµ–æ­¥éª¤

#### æ­¥éª¤ 1: å…‹éš†æˆ–ä¸‹è½½é¡¹ç›®
```bash
# å¦‚æœä» Git ä»“åº“å…‹éš†
git clone <repository-url>
cd week1_2

# æˆ–ç›´æ¥è¿›å…¥é¡¹ç›®ç›®å½•
cd d:\AIå·¥ç¨‹åŒ–è®­ç»ƒè¥\workspace\project\project1_2
```

#### æ­¥éª¤ 2: åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼ˆæ¨èï¼‰
```bash
# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv venv

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
# Windows
venv\Scripts\activate
# macOS/Linux
source venv/bin/activate
```

#### æ­¥éª¤ 3: å®‰è£…ä¾èµ–åŒ…
```bash
# å‡çº§ pip
python -m pip install --upgrade pip

# å®‰è£…é¡¹ç›®ä¾èµ–
pip install -r requirements.txt
```

#### æ­¥éª¤ 4: é…ç½®ç¯å¢ƒå˜é‡
```bash
# å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿
copy .env.example .env  # Windows
cp .env.example .env    # macOS/Linux

# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œå¡«å…¥å¿…è¦çš„é…ç½®
# ç‰¹åˆ«æ˜¯ OPENAI_API_KEYï¼ˆå¦‚æœä½¿ç”¨ OpenAI æœåŠ¡ï¼‰
```

### 3.3 é¡¹ç›®å¯åŠ¨å’Œè¿è¡Œ

#### æ–¹å¼ 1: ç›´æ¥è¿è¡Œä¸»ç¨‹åº
```bash
# åŸºæœ¬è¿è¡Œï¼ˆä½¿ç”¨é»˜è®¤æŸ¥è¯¢ï¼‰
python main.py

# æŒ‡å®šæŸ¥è¯¢å†…å®¹
python main.py --query "æˆ‘çš„è®¢å•ORD001ä¸ºä»€ä¹ˆè¿˜æ²¡å‘è´§ï¼Ÿ"

# æŸ¥çœ‹å¸®åŠ©ä¿¡æ¯
python main.py --help
```

#### æ–¹å¼ 2: åˆ†æ­¥å¯åŠ¨ï¼ˆå¼€å‘è°ƒè¯•ç”¨ï¼‰
```bash
# ç»ˆç«¯ 1: å¯åŠ¨ FastAPI æ¨¡æ‹ŸæœåŠ¡
python api/fastapi_server.py

# ç»ˆç«¯ 2: è¿è¡Œæ™ºèƒ½ä½“ç³»ç»Ÿ
python main.py --query "æˆ‘çš„è®¢å•ORD002çš„ç‰©æµçŠ¶æ€å¦‚ä½•ï¼Ÿ"
```

#### æ–¹å¼ 3: äº¤äº’å¼è¿è¡Œ
```bash
# å¯åŠ¨åä¼šæç¤ºè¾“å…¥æŸ¥è¯¢
python main.py --interactive
```

### 3.4 æµ‹è¯•å’Œæ„å»ºæµç¨‹

#### è¿è¡Œå•å…ƒæµ‹è¯•
```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
pytest

# è¿è¡Œç‰¹å®šæµ‹è¯•æ–‡ä»¶
pytest tests/test_agents.py

# è¿è¡Œæµ‹è¯•å¹¶æ˜¾ç¤ºè¦†ç›–ç‡
pytest --cov=. --cov-report=html
```

#### ä»£ç è´¨é‡æ£€æŸ¥
```bash
# ä»£ç æ ¼å¼åŒ–
black .

# ä»£ç é£æ ¼æ£€æŸ¥
flake8 .

# ç±»å‹æ£€æŸ¥ï¼ˆå¦‚æœé…ç½®äº† mypyï¼‰
mypy .
```

#### æ„å»ºå’Œæ‰“åŒ…
```bash
# ç”Ÿæˆä¾èµ–åŒ…åˆ—è¡¨
pip freeze > requirements.txt

# åˆ›å»ºåˆ†å‘åŒ…ï¼ˆå¦‚æœéœ€è¦ï¼‰
python setup.py sdist bdist_wheel
```

### 3.5 å¸¸ç”¨å‘½ä»¤ç¤ºä¾‹

```bash
# æŸ¥è¯¢ç‰¹å®šè®¢å•
python main.py --query "è®¢å•ORD001çš„çŠ¶æ€å¦‚ä½•ï¼Ÿ"

# æŸ¥è¯¢ç‰©æµä¿¡æ¯
python main.py --query "æˆ‘çš„è®¢å•ORD002ä»€ä¹ˆæ—¶å€™èƒ½åˆ°ï¼Ÿ"

# å¯ç”¨è¯¦ç»†æ—¥å¿—
python main.py --query "è®¢å•æŸ¥è¯¢" --log-level DEBUG

# æµ‹è¯• API è¿æ¥
python -c "from tools.api_client import api_client; import asyncio; asyncio.run(api_client.health_check())"
```

## 4. æ•°æ®æµè¯´æ˜

### 4.1 æ•´ä½“æ•°æ®æµæ¶æ„

```
ç”¨æˆ·æŸ¥è¯¢ â†’ ä¸»ç¨‹åº â†’ AutoGenæ™ºèƒ½ä½“ç³»ç»Ÿ â†’ APIå®¢æˆ·ç«¯ â†’ FastAPIæœåŠ¡ â†’ è¿”å›ç»“æœ
    â†“           â†“            â†“              â†“           â†“
  å‘½ä»¤è¡Œ     main.py    agents/autogen_    tools/     api/
  å‚æ•°                  agents.py       api_client   fastapi_server
                                         .py          .py
```

### 4.2 è¯¦ç»†æ•°æ®æµç¨‹

#### é˜¶æ®µ 1: è¯·æ±‚åˆå§‹åŒ–
1. **ç”¨æˆ·è¾“å…¥**: é€šè¿‡å‘½ä»¤è¡Œä¼ å…¥æŸ¥è¯¢å­—ç¬¦ä¸²
2. **å‚æ•°è§£æ**: `main.py` è§£æå‘½ä»¤è¡Œå‚æ•°å’ŒæŸ¥è¯¢å†…å®¹
3. **æœåŠ¡å¯åŠ¨**: å¯åŠ¨ FastAPI æ¨¡æ‹ŸæœåŠ¡ï¼ˆå¦‚æœæœªè¿è¡Œï¼‰
4. **æ™ºèƒ½ä½“åˆå§‹åŒ–**: åˆ›å»ºä¸‰ä¸ªä¸“é—¨çš„ AutoGen æ™ºèƒ½ä½“

#### é˜¶æ®µ 2: æ™ºèƒ½ä½“åä½œå¤„ç†
1. **æŸ¥è¯¢åˆ†å‘**: ä¸»ç¨‹åºå°†ç”¨æˆ·æŸ¥è¯¢å‘é€ç»™ AutoGen ç¾¤ç»„èŠå¤©ç®¡ç†å™¨
2. **ä»»åŠ¡åˆ†è§£**: æ™ºèƒ½ä½“ç³»ç»Ÿè‡ªåŠ¨è¯†åˆ«éœ€è¦æ‰§è¡Œçš„ä»»åŠ¡ç±»å‹
3. **å¹¶è¡Œå¤„ç†**:
   - **Agent A (è®¢å•æŸ¥è¯¢æ™ºèƒ½ä½“)**: 
     - ä»æŸ¥è¯¢ä¸­æå–è®¢å•ID
     - è°ƒç”¨ `api_client.get_order_status(order_id)`
     - è¿”å›è®¢å•çŠ¶æ€ä¿¡æ¯
   - **Agent B (ç‰©æµæŸ¥è¯¢æ™ºèƒ½ä½“)**:
     - ä½¿ç”¨ç›¸åŒçš„è®¢å•ID
     - è°ƒç”¨ `api_client.get_logistics_info(order_id)`
     - è¿”å›ç‰©æµè·Ÿè¸ªä¿¡æ¯
4. **ç»“æœæ±‡æ€»**: Agent C æ”¶é›†å‰ä¸¤ä¸ªæ™ºèƒ½ä½“çš„ç»“æœï¼Œç”Ÿæˆç”¨æˆ·å‹å¥½çš„å›å¤

#### é˜¶æ®µ 3: API è°ƒç”¨å’Œæ•°æ®è·å–
1. **HTTP è¯·æ±‚**: API å®¢æˆ·ç«¯å‘ FastAPI æœåŠ¡å‘é€ HTTP è¯·æ±‚
2. **é‡è¯•æœºåˆ¶**: å¦‚æœè¯·æ±‚å¤±è´¥ï¼Œè‡ªåŠ¨æ‰§è¡ŒæŒ‡æ•°é€€é¿é‡è¯•
3. **æ•°æ®è§£æ**: å°† JSON å“åº”è§£æä¸º Python å­—å…¸
4. **é”™è¯¯å¤„ç†**: å¤„ç†ç½‘ç»œé”™è¯¯ã€è¶…æ—¶ã€404ç­‰å¼‚å¸¸æƒ…å†µ

#### é˜¶æ®µ 4: ç»“æœè¿”å›å’Œå±•ç¤º
1. **æ•°æ®æ•´åˆ**: å°†è®¢å•å’Œç‰©æµä¿¡æ¯æ•´åˆä¸ºå®Œæ•´çš„å›å¤
2. **æ ¼å¼åŒ–è¾“å‡º**: ä½¿ç”¨ Rich åº“åˆ›å»ºç¾è§‚çš„å‘½ä»¤è¡Œç•Œé¢å±•ç¤º
3. **æ—¥å¿—è®°å½•**: è®°å½•æ•´ä¸ªå¤„ç†è¿‡ç¨‹çš„è¯¦ç»†æ—¥å¿—
4. **ç”¨æˆ·åé¦ˆ**: å‘ç”¨æˆ·å±•ç¤ºæœ€ç»ˆçš„æŸ¥è¯¢ç»“æœ

### 4.3 ä¸»è¦æ¨¡å—é—´çš„äº¤äº’æ–¹å¼

#### AutoGen æ™ºèƒ½ä½“é€šä¿¡åè®®
```python
# æ™ºèƒ½ä½“é—´çš„æ¶ˆæ¯ä¼ é€’æ ¼å¼
{
    "role": "user|assistant|system",
    "content": "æ¶ˆæ¯å†…å®¹",
    "name": "æ™ºèƒ½ä½“åç§°",
    "function_call": {
        "name": "å‡½æ•°å",
        "arguments": "å‚æ•°"
    }
}
```

#### API è°ƒç”¨æ¥å£è§„èŒƒ
```python
# è®¢å•æŸ¥è¯¢æ¥å£
GET /api/orders/{order_id}
Response: {
    "order_id": "ORD001",
    "status": "processing|shipped|delivered",
    "customer_name": "å®¢æˆ·å§“å",
    "total_amount": 299.99,
    "items": ["å•†å“åˆ—è¡¨"],
    "shipping_address": "é…é€åœ°å€",
    "created_at": "åˆ›å»ºæ—¶é—´",
    "updated_at": "æ›´æ–°æ—¶é—´",
    "estimated_delivery": "é¢„è®¡é€è¾¾æ—¶é—´"
}

# ç‰©æµæŸ¥è¯¢æ¥å£
GET /api/logistics/{order_id}
Response: {
    "order_id": "ORD001",
    "tracking_number": "å¿«é€’å•å·",
    "status": "not_shipped|in_transit|out_for_delivery|delivered",
    "current_location": "å½“å‰ä½ç½®",
    "carrier": "æ‰¿è¿å•†",
    "estimated_delivery": "é¢„è®¡é€è¾¾æ—¶é—´",
    "tracking_history": [
        {
            "time": "æ—¶é—´",
            "location": "åœ°ç‚¹",
            "status": "çŠ¶æ€"
        }
    ]
}
```

### 4.4 å…³é”®APIè°ƒç”¨å’Œæ•°æ®è½¬æ¢

#### é‡è¯•æœºåˆ¶å®ç°
```python
@create_retry_decorator(max_attempts=3, min_wait=1.0, max_wait=10.0)
async def api_call():
    # æŒ‡æ•°é€€é¿: 1s â†’ 2s â†’ 4s â†’ 8s
    # æœ€å¤§ç­‰å¾…æ—¶é—´: 10s
    # æœ€å¤§é‡è¯•æ¬¡æ•°: 3æ¬¡
```

#### æ•°æ®è½¬æ¢æµç¨‹
1. **åŸå§‹æŸ¥è¯¢** â†’ **è®¢å•IDæå–** â†’ **APIè°ƒç”¨å‚æ•°**
2. **JSONå“åº”** â†’ **Pythonå­—å…¸** â†’ **æ™ºèƒ½ä½“æ¶ˆæ¯æ ¼å¼**
3. **å¤šä¸ªAPIç»“æœ** â†’ **æ•´åˆæ•°æ®** â†’ **ç”¨æˆ·å‹å¥½æ–‡æœ¬**

#### å¼‚æ­¥å¤„ç†æœºåˆ¶
- ä½¿ç”¨ `asyncio` å®ç°å¹¶å‘APIè°ƒç”¨
- æ™ºèƒ½ä½“å¯ä»¥å¹¶è¡Œå¤„ç†ä¸åŒçš„ä»»åŠ¡
- éé˜»å¡çš„ç”¨æˆ·ç•Œé¢æ›´æ–°

## 5. å…¶ä»–å¿…è¦å†…å®¹

### 5.1 é¡¹ç›®éƒ¨ç½²è¯´æ˜

#### å¼€å‘ç¯å¢ƒéƒ¨ç½²
1. **æœ¬åœ°å¼€å‘**:
   ```bash
   # å…‹éš†é¡¹ç›®
   git clone <repository>
   cd week1_2
   
   # å®‰è£…ä¾èµ–
   pip install -r requirements.txt
   
   # é…ç½®ç¯å¢ƒå˜é‡
   cp .env.example .env
   
   # è¿è¡Œé¡¹ç›®
   python main.py
   ```

2. **Docker éƒ¨ç½²**ï¼ˆæ¨èç”¨äºç”Ÿäº§ç¯å¢ƒï¼‰:
   ```dockerfile
   # Dockerfile ç¤ºä¾‹
   FROM python:3.9-slim
   WORKDIR /app
   COPY requirements.txt .
   RUN pip install -r requirements.txt
   COPY . .
   CMD ["python", "main.py"]
   ```

#### ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²
1. **æœåŠ¡å™¨è¦æ±‚**:
   - CPU: 2æ ¸å¿ƒä»¥ä¸Š
   - å†…å­˜: 4GBä»¥ä¸Š
   - å­˜å‚¨: 10GBä»¥ä¸Š
   - ç½‘ç»œ: ç¨³å®šçš„äº’è”ç½‘è¿æ¥

2. **ç¯å¢ƒé…ç½®**:
   ```bash
   # å®‰è£…ç³»ç»Ÿä¾èµ–
   sudo apt-get update
   sudo apt-get install python3 python3-pip
   
   # åˆ›å»ºæœåŠ¡ç”¨æˆ·
   sudo useradd -m -s /bin/bash autogen-service
   
   # éƒ¨ç½²åº”ç”¨
   sudo -u autogen-service git clone <repository>
   cd /home/autogen-service/week1_2
   sudo -u autogen-service pip install -r requirements.txt
   ```

3. **ç³»ç»ŸæœåŠ¡é…ç½®**:
   ```ini
   # /etc/systemd/system/autogen-service.service
   [Unit]
   Description=AutoGen Multi-Agent Customer Service
   After=network.target
   
   [Service]
   Type=simple
   User=autogen-service
   WorkingDirectory=/home/autogen-service/week1_2
   ExecStart=/usr/bin/python3 main.py
   Restart=always
   
   [Install]
   WantedBy=multi-user.target
   ```

### 5.2 å¸¸è§é—®é¢˜è§£å†³æ–¹æ¡ˆ

#### Q1: OpenAI API è¿æ¥å¤±è´¥
**é—®é¢˜**: `openai.error.AuthenticationError: Invalid API key`
**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥ `.env` æ–‡ä»¶ä¸­çš„ `OPENAI_API_KEY` æ˜¯å¦æ­£ç¡®
2. ç¡®è®¤ API å¯†é’¥æœ‰è¶³å¤Ÿçš„é…é¢
3. æ£€æŸ¥ç½‘ç»œè¿æ¥å’Œé˜²ç«å¢™è®¾ç½®
4. å°è¯•ä½¿ç”¨ä»£ç†æœåŠ¡å™¨

#### Q2: FastAPI æœåŠ¡å¯åŠ¨å¤±è´¥
**é—®é¢˜**: `OSError: [Errno 98] Address already in use`
**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥ç«¯å£ 8000 æ˜¯å¦è¢«å ç”¨: `netstat -tulpn | grep 8000`
2. ç»ˆæ­¢å ç”¨ç«¯å£çš„è¿›ç¨‹: `kill -9 <PID>`
3. ä¿®æ”¹é…ç½®æ–‡ä»¶ä¸­çš„ç«¯å£å·
4. ä½¿ç”¨ä¸åŒçš„ç«¯å£å¯åŠ¨æœåŠ¡

#### Q3: ä¾èµ–åŒ…å®‰è£…å¤±è´¥
**é—®é¢˜**: `pip install` è¿‡ç¨‹ä¸­å‡ºç°ç¼–è¯‘é”™è¯¯
**è§£å†³æ–¹æ¡ˆ**:
1. å‡çº§ pip: `python -m pip install --upgrade pip`
2. å®‰è£…ç³»ç»Ÿä¾èµ–: `sudo apt-get install python3-dev build-essential`
3. ä½¿ç”¨é¢„ç¼–è¯‘åŒ…: `pip install --only-binary=all <package>`
4. ä½¿ç”¨å›½å†…é•œåƒæº: `pip install -i https://pypi.tuna.tsinghua.edu.cn/simple/`

#### Q4: æ™ºèƒ½ä½“å“åº”ç¼“æ…¢
**é—®é¢˜**: AutoGen æ™ºèƒ½ä½“å¤„ç†æ—¶é—´è¿‡é•¿
**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥ç½‘ç»œè¿æ¥è´¨é‡
2. è°ƒæ•´ `settings.py` ä¸­çš„è¶…æ—¶å‚æ•°
3. ä¼˜åŒ–æ™ºèƒ½ä½“çš„æç¤ºè¯é•¿åº¦
4. ä½¿ç”¨æ›´å¿«çš„ OpenAI æ¨¡å‹ï¼ˆå¦‚ gpt-3.5-turboï¼‰

#### Q5: æ—¥å¿—æ–‡ä»¶è¿‡å¤§
**é—®é¢˜**: `logs/app.log` æ–‡ä»¶å ç”¨è¿‡å¤šç£ç›˜ç©ºé—´
**è§£å†³æ–¹æ¡ˆ**:
1. æ—¥å¿—è‡ªåŠ¨è½®è½¬å·²é…ç½®ï¼ˆ10MBï¼Œä¿ç•™5ä¸ªæ–‡ä»¶ï¼‰
2. æ‰‹åŠ¨æ¸…ç†æ—§æ—¥å¿—: `rm logs/app.log.*`
3. è°ƒæ•´æ—¥å¿—çº§åˆ«: å°† `LOG_LEVEL` è®¾ç½®ä¸º `WARNING` æˆ– `ERROR`
4. å®šæœŸæ¸…ç†æ—¥å¿—çš„ cron ä»»åŠ¡

### 5.3 ç»´æŠ¤å’Œæ‰©å±•å»ºè®®

#### ä»£ç ç»´æŠ¤
1. **å®šæœŸæ›´æ–°ä¾èµ–**:
   ```bash
   # æ£€æŸ¥è¿‡æ—¶çš„åŒ…
   pip list --outdated
   
   # æ›´æ–°ç‰¹å®šåŒ…
   pip install --upgrade <package-name>
   
   # æ›´æ–°æ‰€æœ‰åŒ…ï¼ˆè°¨æ…ä½¿ç”¨ï¼‰
   pip freeze | cut -d'=' -f1 | xargs pip install --upgrade
   ```

2. **ä»£ç è´¨é‡ä¿è¯**:
   - ä½¿ç”¨ `black` è¿›è¡Œä»£ç æ ¼å¼åŒ–
   - ä½¿ç”¨ `flake8` è¿›è¡Œä»£ç é£æ ¼æ£€æŸ¥
   - ç¼–å†™å•å…ƒæµ‹è¯•è¦†ç›–æ ¸å¿ƒåŠŸèƒ½
   - å®šæœŸè¿›è¡Œä»£ç å®¡æŸ¥

3. **æ€§èƒ½ç›‘æ§**:
   - ç›‘æ§ API å“åº”æ—¶é—´
   - è·Ÿè¸ªæ™ºèƒ½ä½“å¤„ç†æ•ˆç‡
   - è®°å½•ç³»ç»Ÿèµ„æºä½¿ç”¨æƒ…å†µ
   - è®¾ç½®å‘Šè­¦æœºåˆ¶

#### åŠŸèƒ½æ‰©å±•å»ºè®®
1. **æ–°å¢æ™ºèƒ½ä½“ç±»å‹**:
   - é€€æ¬¾å¤„ç†æ™ºèƒ½ä½“
   - äº§å“æ¨èæ™ºèƒ½ä½“
   - æŠ•è¯‰å¤„ç†æ™ºèƒ½ä½“

2. **å¢å¼ºæ•°æ®æº**:
   - è¿æ¥çœŸå®çš„è®¢å•ç®¡ç†ç³»ç»Ÿ
   - é›†æˆå¤šä¸ªç‰©æµæœåŠ¡å•†API
   - æ·»åŠ å®¢æˆ·å†å²è®°å½•æŸ¥è¯¢

3. **ç”¨æˆ·ç•Œé¢æ”¹è¿›**:
   - å¼€å‘ Web ç•Œé¢
   - æ·»åŠ è¯­éŸ³äº¤äº’åŠŸèƒ½
   - æ”¯æŒå¤šè¯­è¨€ç•Œé¢

4. **æ™ºèƒ½åŒ–æå‡**:
   - å®ç°æ™ºèƒ½ä½“å­¦ä¹ æœºåˆ¶
   - æ·»åŠ æƒ…æ„Ÿåˆ†æåŠŸèƒ½
   - æ”¯æŒä¸Šä¸‹æ–‡è®°å¿†

#### å®‰å…¨æ€§è€ƒè™‘
1. **API å®‰å…¨**:
   - å®ç° API å¯†é’¥è½®æ¢
   - æ·»åŠ è¯·æ±‚é¢‘ç‡é™åˆ¶
   - ä½¿ç”¨ HTTPS åŠ å¯†é€šä¿¡

2. **æ•°æ®ä¿æŠ¤**:
   - æ•æ„Ÿä¿¡æ¯è„±æ•å¤„ç†
   - å®ç°æ•°æ®åŠ å¯†å­˜å‚¨
   - å®šæœŸå¤‡ä»½é‡è¦æ•°æ®

3. **è®¿é—®æ§åˆ¶**:
   - å®ç°ç”¨æˆ·èº«ä»½éªŒè¯
   - æ·»åŠ è§’è‰²æƒé™ç®¡ç†
   - è®°å½•æ“ä½œå®¡è®¡æ—¥å¿—

#### æ‰©å±•æ€§è®¾è®¡
1. **å¾®æœåŠ¡æ¶æ„**:
   - å°†ä¸åŒåŠŸèƒ½æ‹†åˆ†ä¸ºç‹¬ç«‹æœåŠ¡
   - ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—è¿›è¡ŒæœåŠ¡é—´é€šä¿¡
   - å®ç°æœåŠ¡å‘ç°å’Œè´Ÿè½½å‡è¡¡

2. **æ•°æ®åº“é›†æˆ**:
   - æ·»åŠ æŒä¹…åŒ–å­˜å‚¨
   - å®ç°æ•°æ®ç¼“å­˜æœºåˆ¶
   - æ”¯æŒåˆ†å¸ƒå¼æ•°æ®åº“

3. **äº‘åŸç”Ÿéƒ¨ç½²**:
   - å®¹å™¨åŒ–éƒ¨ç½²
   - Kubernetes ç¼–æ’
   - è‡ªåŠ¨æ‰©ç¼©å®¹

---

## é™„å½•

### A. ç¯å¢ƒå˜é‡é…ç½®å‚è€ƒ
```bash
# OpenAI é…ç½®
OPENAI_API_KEY=sk-your-api-key-here
OPENAI_MODEL=gpt-4o
OPENAI_BASE_URL=https://api.openai.com/v1

# æœåŠ¡é…ç½®
MOCK_SERVER_HOST=127.0.0.1
MOCK_SERVER_PORT=8000

# é‡è¯•é…ç½®
MAX_RETRIES=3
RETRY_DELAY=1.0
TIMEOUT=30

# æ—¥å¿—é…ç½®
LOG_LEVEL=INFO
LOG_FILE=logs/app.log
```

### B. å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥
```bash
# é¡¹ç›®å¯åŠ¨
python main.py --query "è®¢å•æŸ¥è¯¢"

# å¼€å‘è°ƒè¯•
python main.py --log-level DEBUG

# æµ‹è¯•è¿è¡Œ
pytest tests/

# ä»£ç æ ¼å¼åŒ–
black .

# ä¾èµ–ç®¡ç†
pip freeze > requirements.txt
```

### C. é¡¹ç›®è´¡çŒ®æŒ‡å—
1. Fork é¡¹ç›®ä»“åº“
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯: `git checkout -b feature/new-feature`
3. æäº¤æ›´æ”¹: `git commit -am 'Add new feature'`
4. æ¨é€åˆ†æ”¯: `git push origin feature/new-feature`
5. åˆ›å»º Pull Request

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**æœ€åæ›´æ–°**: 2024å¹´1æœˆ  
**ç»´æŠ¤è€…**: AutoGen å¤šæ™ºèƒ½ä½“å®¢æœç³»ç»Ÿå¼€å‘å›¢é˜Ÿ  

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·é€šè¿‡é¡¹ç›® Issues é¡µé¢åé¦ˆã€‚